(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{873:function(e,g,l){"use strict";l.r(g);var d=l(1),t=Object(d.a)({},(function(){var e=this,g=e.$createElement,l=e._self._c||g;return l("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[l("h1",{attrs:{id:"handlers"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[e._v("#")]),e._v(" Handlers")]),e._v(" "),l("h2",{attrs:{hide:"",id:"pre-requisite-readings"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#pre-requisite-readings"}},[e._v("#")]),e._v(" Pre-requisite Readings")]),e._v(" "),l("ul",[l("li",{attrs:{prereq:""}},[l("RouterLink",{attrs:{to:"/building-modules/module-manager.html"}},[e._v("Module Manager")])],1),e._v(" "),l("li",{attrs:{prereq:""}},[l("RouterLink",{attrs:{to:"/building-modules/messages-and-queries.html"}},[e._v("Messages and Queries")])],1)]),e._v(" "),l("h2",{attrs:{id:"handler-type"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#handler-type"}},[e._v("#")]),e._v(" "),l("code",[e._v("handler")]),e._v(" type")]),e._v(" "),l("p",[e._v("The "),l("code",[e._v("handler")]),e._v(" type defined in the Cosmos SDK specifies the typical structure of a "),l("code",[e._v("handler")]),e._v(" function.")]),e._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSB0eXBlcwoKLy8gSGFuZGxlciBkZWZpbmVzIHRoZSBjb3JlIG9mIHRoZSBzdGF0ZSB0cmFuc2l0aW9uIGZ1bmN0aW9uIG9mIGFuIGFwcGxpY2F0aW9uLgp0eXBlIEhhbmRsZXIgZnVuYyhjdHggQ29udGV4dCwgbXNnIE1zZykgUmVzdWx0CgovLyBBbnRlSGFuZGxlciBhdXRoZW50aWNhdGVzIHRyYW5zYWN0aW9ucywgYmVmb3JlIHRoZWlyIGludGVybmFsIG1lc3NhZ2VzIGFyZSBoYW5kbGVkLgovLyBJZiBuZXdDdHguSXNaZXJvKCksIGN0eCBpcyB1c2VkIGluc3RlYWQuCnR5cGUgQW50ZUhhbmRsZXIgZnVuYyhjdHggQ29udGV4dCwgdHggVHgsIHNpbXVsYXRlIGJvb2wpIChuZXdDdHggQ29udGV4dCwgZXJyIGVycm9yKQoKLy8gQW50ZURlY29yYXRvciB3cmFwcyB0aGUgbmV4dCBBbnRlSGFuZGxlciB0byBwZXJmb3JtIGN1c3RvbSBwcmUtIGFuZCBwb3N0LXByb2Nlc3NpbmcuCnR5cGUgQW50ZURlY29yYXRvciBpbnRlcmZhY2UgewoJQW50ZUhhbmRsZShjdHggQ29udGV4dCwgdHggVHgsIHNpbXVsYXRlIGJvb2wsIG5leHQgQW50ZUhhbmRsZXIpIChuZXdDdHggQ29udGV4dCwgZXJyIGVycm9yKQp9CgovLyBDaGFpbkRlY29yYXRvciBjaGFpbnMgQW50ZURlY29yYXRvcnMgdG9nZXRoZXIgd2l0aCBlYWNoIEFudGVEZWNvcmF0b3IKLy8gd3JhcHBpbmcgb3ZlciB0aGUgZGVjb3JhdG9ycyBmdXJ0aGVyIGFsb25nIGNoYWluIGFuZCByZXR1cm5zIGEgc2luZ2xlIEFudGVIYW5kbGVyLgovLwovLyBOT1RFOiBUaGUgZmlyc3QgZWxlbWVudCBpcyBvdXRlcm1vc3QgZGVjb3JhdG9yLCB3aGlsZSB0aGUgbGFzdCBlbGVtZW50IGlzIGlubmVybW9zdAovLyBkZWNvcmF0b3IuIERlY29yYXRvciBvcmRlcmluZyBpcyBjcml0aWNhbCBzaW5jZSBzb21lIGRlY29yYXRvcnMgd2lsbCBleHBlY3QKLy8gY2VydGFpbiBjaGVja3MgYW5kIHVwZGF0ZXMgdG8gYmUgcGVyZm9ybWVkIChlLmcuIHRoZSBDb250ZXh0KSBiZWZvcmUgdGhlIGRlY29yYXRvcgovLyBpcyBydW4uIFRoZXNlIGV4cGVjdGF0aW9ucyBzaG91bGQgYmUgZG9jdW1lbnRlZCBjbGVhcmx5IGluIGEgQ09OVFJBQ1QgZG9jbGluZQovLyBpbiB0aGUgZGVjb3JhdG9yJ3MgZ29kb2MuCi8vCi8vIE5PVEU6IEFueSBhcHBsaWNhdGlvbiB0aGF0IHVzZXMgR2FzTWV0ZXIgdG8gbGltaXQgdHJhbnNhY3Rpb24gcHJvY2Vzc2luZyBjb3N0Ci8vIE1VU1Qgc2V0IEdhc01ldGVyIHdpdGggdGhlIEZJUlNUIEFudGVEZWNvcmF0b3IuIEZhaWxpbmcgdG8gZG8gc28gd2lsbCBjYXVzZQovLyB0cmFuc2FjdGlvbnMgdG8gYmUgcHJvY2Vzc2VkIHdpdGggYW4gaW5maW5pdGUgZ2FzbWV0ZXIgYW5kIG9wZW4gYSBET1MgYXR0YWNrIHZlY3Rvci4KLy8gVXNlIGBhbnRlLlNldFVwQ29udGV4dERlY29yYXRvcmAgb3IgYSBjdXN0b20gRGVjb3JhdG9yIHdpdGggc2ltaWxhciBmdW5jdGlvbmFsaXR5LgpmdW5jIENoYWluQW50ZURlY29yYXRvcnMoY2hhaW4gLi4uQW50ZURlY29yYXRvcikgQW50ZUhhbmRsZXIgewoJaWYgKGNoYWluW2xlbihjaGFpbiktMV0gIT0gVGVybWluYXRvcnt9KSB7CgkJY2hhaW4gPSBhcHBlbmQoY2hhaW4sIFRlcm1pbmF0b3J7fSkKCX0KCglpZiBsZW4oY2hhaW4pID09IDEgewoJCXJldHVybiBmdW5jKGN0eCBDb250ZXh0LCB0eCBUeCwgc2ltdWxhdGUgYm9vbCkgKENvbnRleHQsIGVycm9yKSB7CgkJCXJldHVybiBjaGFpblswXS5BbnRlSGFuZGxlKGN0eCwgdHgsIHNpbXVsYXRlLCBuaWwpCgkJfQoJfQoKCXJldHVybiBmdW5jKGN0eCBDb250ZXh0LCB0eCBUeCwgc2ltdWxhdGUgYm9vbCkgKENvbnRleHQsIGVycm9yKSB7CgkJcmV0dXJuIGNoYWluWzBdLkFudGVIYW5kbGUoY3R4LCB0eCwgc2ltdWxhdGUsIENoYWluQW50ZURlY29yYXRvcnMoY2hhaW5bMTpdLi4uKSkKCX0KfQoKLy8gVGVybWluYXRvciBBbnRlRGVjb3JhdG9yIHdpbGwgZ2V0IGFkZGVkIHRvIHRoZSBjaGFpbiB0byBzaW1wbGlmeSBkZWNvcmF0b3IgY29kZQovLyBEb24ndCBuZWVkIHRvIGNoZWNrIGlmIG5leHQgPT0gbmlsIGZ1cnRoZXIgdXAgdGhlIGNoYWluCi8vICAgICAgICAgICAgICAgICAgICAgICAgX19fX19fCi8vICAgICAgICAgICAgICAgICAgICAgJmx0OygoKCgoKFxcXAovLyAgICAgICAgICAgICAgICAgICAgIC8gICAgICAuIH1cCi8vICAgICAgICAgICAgICAgICAgICAgOy0tLi4tLS5ffH0KLy8gIChcICAgICAgICAgICAgICAgICAnLS0vXC0tJyAgKQovLyAgIFxcICAgICAgICAgICAgICAgIHwgJy0nICA6J3wKLy8gICAgXFwgICAgICAgICAgICAgICAuIC09PS0gLi18Ci8vICAgICBcXCAgICAgICAgICAgICAgIFwuX18uJyAgIFwtLS5fCi8vICAgICBbXFwgICAgICAgICAgX18uLS18ICAgICAgIC8vICBfLyctLS4KLy8gICAgIFwgXFwgICAgICAgLictLl8gKCctLS0tLScvIF9fLyAgICAgIFwKLy8gICAgICBcIFxcICAgICAvICAgX18mZ3Q7fCAgICAgIHwgJy0tLiAgICAgICB8Ci8vICAgICAgIFwgXFwgICB8ICAgXCAgIHwgICAgIC8gICAgLyAgICAgICAvCi8vICAgICAgICBcICdcIC8gICAgIFwgIHwgICAgIHwgIF8vICAgICAgIC8KLy8gICAgICAgICBcICBcICAgICAgIFwgfCAgICAgfCAvICAgICAgICAvCi8vICAgc25kICAgIFwgIFwgICAgICBcICAgICAgICAvCnR5cGUgVGVybWluYXRvciBzdHJ1Y3R7fQoKLy8gU2ltcGx5IHJldHVybiBwcm92aWRlZCBDb250ZXh0IGFuZCBuaWwgZXJyb3IKZnVuYyAodCBUZXJtaW5hdG9yKSBBbnRlSGFuZGxlKGN0eCBDb250ZXh0LCBfIFR4LCBfIGJvb2wsIF8gQW50ZUhhbmRsZXIpIChDb250ZXh0LCBlcnJvcikgewoJcmV0dXJuIGN0eCwgbmlsCn0K"}})],1),e._v(" "),l("p",[e._v("Let us break it down:")]),e._v(" "),l("ul",[l("li",[e._v("The "),l("RouterLink",{attrs:{to:"/building-modules/messages-and-queries.html#messages"}},[l("code",[e._v("Msg")])]),e._v(" is the actual object being processed.")],1),e._v(" "),l("li",[e._v("The "),l("RouterLink",{attrs:{to:"/core/context.html"}},[l("code",[e._v("Context")])]),e._v(" contains all the necessary information needed to process the "),l("code",[e._v("msg")]),e._v(", as well as a cache-wrapped copy of the latest state. If the "),l("code",[e._v("msg")]),e._v(" is succesfully processed, the modified version of the temporary state contained in the "),l("code",[e._v("ctx")]),e._v(" will be written to the main state.")],1),e._v(" "),l("li",[e._v("The ["),l("code",[e._v("Result")]),e._v("] returned to "),l("code",[e._v("baseapp")]),e._v(", which contains (among other things) information on the execution of the "),l("code",[e._v("handler")]),e._v(", "),l("RouterLink",{attrs:{to:"/basics/gas-fees.html"}},[l("code",[e._v("gas")])]),e._v(" consumption and "),l("RouterLink",{attrs:{to:"/core/events.html"}},[l("code",[e._v("events")])]),e._v(".\n"),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gUmVzdWx0IGlzIHRoZSB1bmlvbiBvZiBSZXNwb25zZUZvcm1hdCBhbmQgUmVzcG9uc2VDaGVja1R4Lgp0eXBlIFJlc3VsdCBzdHJ1Y3QgewoJLy8gQ29kZSBpcyB0aGUgcmVzcG9uc2UgY29kZSwgaXMgc3RvcmVkIGJhY2sgb24gdGhlIGNoYWluLgoJQ29kZSBDb2RlVHlwZQoKCS8vIENvZGVzcGFjZSBpcyB0aGUgc3RyaW5nIHJlZmVycmluZyB0byB0aGUgZG9tYWluIG9mIGFuIGVycm9yCglDb2Rlc3BhY2UgQ29kZXNwYWNlVHlwZQoKCS8vIERhdGEgaXMgYW55IGRhdGEgcmV0dXJuZWQgZnJvbSB0aGUgYXBwLgoJLy8gRGF0YSBoYXMgdG8gYmUgbGVuZ3RoIHByZWZpeGVkIGluIG9yZGVyIHRvIHNlcGFyYXRlCgkvLyByZXN1bHRzIGZyb20gbXVsdGlwbGUgbXNncyBleGVjdXRpb25zCglEYXRhIFtdYnl0ZQoKCS8vIExvZyBjb250YWlucyB0aGUgdHhzIGxvZyBpbmZvcm1hdGlvbi4gTk9URTogbm9uZGV0ZXJtaW5pc3RpYy4KCUxvZyBzdHJpbmcKCgkvLyBHYXNXYW50ZWQgaXMgdGhlIG1heGltdW0gdW5pdHMgb2Ygd29yayB3ZSBhbGxvdyB0aGlzIHR4IHRvIHBlcmZvcm0uCglHYXNXYW50ZWQgdWludDY0CgoJLy8gR2FzVXNlZCBpcyB0aGUgYW1vdW50IG9mIGdhcyBhY3R1YWxseSBjb25zdW1lZC4gTk9URTogdW5pbXBsZW1lbnRlZAoJR2FzVXNlZCB1aW50NjQKCgkvLyBFdmVudHMgY29udGFpbnMgYSBzbGljZSBvZiBFdmVudCBvYmplY3RzIHRoYXQgd2VyZSBlbWl0dGVkIGR1cmluZyBzb21lCgkvLyBleGVjdXRpb24uCglFdmVudHMgRXZlbnRzCn0="}})],1)]),e._v(" "),l("h2",{attrs:{id:"implementation-of-a-module-handlers"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#implementation-of-a-module-handlers"}},[e._v("#")]),e._v(" Implementation of a module "),l("code",[e._v("handler")]),e._v("s")]),e._v(" "),l("p",[e._v("Module "),l("code",[e._v("handler")]),e._v("s are typically implemented in a "),l("code",[e._v("./handler.go")]),e._v(" file inside the module's folder. The\n"),l("RouterLink",{attrs:{to:"/building-modules/module-manager.html"}},[e._v("module manager")]),e._v(" is used to add the module's "),l("code",[e._v("handler")]),e._v("s to the\n"),l("RouterLink",{attrs:{to:"/core/baseapp.html#message-routing"}},[e._v("application's "),l("code",[e._v("router")])]),e._v(" via the "),l("code",[e._v("NewHandler()")]),e._v(" method. Typically,\nthe manager's "),l("code",[e._v("NewHandler()")]),e._v(" method simply calls a "),l("code",[e._v("NewHandler()")]),e._v(" method defined in "),l("code",[e._v("handler.go")]),e._v(",\nwhich looks like the following:")],1),e._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBOZXdIYW5kbGVyKGtlZXBlciBLZWVwZXIpIHNkay5IYW5kbGVyIHsKCXJldHVybiBmdW5jKGN0eCBzZGsuQ29udGV4dCwgbXNnIHNkay5Nc2cpICgqc2RrLlJlc3VsdCwgZXJyb3IpIHsKCQlzd2l0Y2ggbXNnIDo9IG1zZy4odHlwZSkgewoJCWNhc2UgTXNnVHlwZTE6CgkJCXJldHVybiBoYW5kbGVNc2dUeXBlMShjdHgsIGtlZXBlciwgbXNnKQoKCQljYXNlIE1zZ1R5cGUyOgoJCQlyZXR1cm4gaGFuZGxlTXNnVHlwZTIoY3R4LCBrZWVwZXIsIG1zZykKCgkJZGVmYXVsdDoKCQkJcmV0dXJuIG5pbCwgc2RrZXJyb3JzLldyYXBmKHNka2Vycm9ycy5FcnJVbmtub3duUmVxdWVzdCwgJnF1b3Q7dW5yZWNvZ25pemVkICVzIG1lc3NhZ2UgdHlwZTogJVQmcXVvdDssIE1vZHVsZU5hbWUsIG1zZykKCQl9Cgl9Cn0K"}}),e._v(" "),l("p",[e._v("This simple switch returns a "),l("code",[e._v("handler")]),e._v(" function specific to the type of the received "),l("code",[e._v("message")]),e._v(". These "),l("code",[e._v("handler")]),e._v(" functions are the ones that actually process "),l("code",[e._v("message")]),e._v("s, and usually follow the following 2 steps:")]),e._v(" "),l("ul",[l("li",[e._v("First, they perform "),l("em",[e._v("stateful")]),e._v(" checks to make sure the "),l("code",[e._v("message")]),e._v(" is valid. At this stage, the "),l("code",[e._v("message")]),e._v("'s "),l("code",[e._v("ValidateBasic()")]),e._v(" method has already been called, meaning "),l("em",[e._v("stateless")]),e._v(" checks on the message (like making sure parameters are correctly formatted) have already been performed. Checks performed in the "),l("code",[e._v("handler")]),e._v(" can be more expensive and require access to the state. For example, a "),l("code",[e._v("handler")]),e._v(" for a "),l("code",[e._v("transfer")]),e._v(" message might check that the sending account has enough funds to actually perform the transfer. To access the state, the "),l("code",[e._v("handler")]),e._v(" needs to call the "),l("RouterLink",{attrs:{to:"/building-modules/keeper.html"}},[l("code",[e._v("keeper")]),e._v("'s")]),e._v(" getter functions.")],1),e._v(" "),l("li",[e._v("Then, if the checks are successfull, the "),l("code",[e._v("handler")]),e._v(" calls the "),l("RouterLink",{attrs:{to:"/building-modules/keeper.html"}},[l("code",[e._v("keeper")]),e._v("'s")]),e._v(" setter functions to actually perform the state transition.")],1)]),e._v(" "),l("p",[e._v("Before returning, "),l("code",[e._v("handler")]),e._v(" functions generally emit one or multiple "),l("RouterLink",{attrs:{to:"/core/events.html"}},[l("code",[e._v("events")])]),e._v(" via the "),l("code",[e._v("EventManager")]),e._v(" held in the "),l("code",[e._v("ctx")]),e._v(":")],1),e._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Y3R4LkV2ZW50TWFuYWdlcigpLkVtaXRFdmVudCgKCQlzZGsuTmV3RXZlbnQoCgkJCWV2ZW50VHlwZSwgIC8vIGUuZy4gc2RrLkV2ZW50VHlwZU1lc3NhZ2UgZm9yIGEgbWVzc2FnZSwgdHlwZXMuQ3VzdG9tRXZlbnRUeXBlIGZvciBhIGN1c3RvbSBldmVudCBkZWZpbmVkIGluIHRoZSBtb2R1bGUKCQkJc2RrLk5ld0F0dHJpYnV0ZShhdHRyaWJ1dGVLZXksIGF0dHJpYnV0ZVZhbHVlKSwKCQkpLAogICAgKQo="}}),e._v(" "),l("p",[e._v("These "),l("code",[e._v("events")]),e._v(" are relayed back to the underlying consensus engine and can be used by service providers to implement services around the application. Click "),l("RouterLink",{attrs:{to:"/core/events.html"}},[e._v("here")]),e._v(" to learn more about "),l("code",[e._v("events")]),e._v(".")],1),e._v(" "),l("p",[e._v("Finally, the "),l("code",[e._v("handler")]),e._v(" function returns a "),l("code",[e._v("sdk.Result")]),e._v(" which contains the aforementioned "),l("code",[e._v("events")]),e._v(" and an optional "),l("code",[e._v("Data")]),e._v(" field.")]),e._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gUmVzdWx0IGlzIHRoZSB1bmlvbiBvZiBSZXNwb25zZUZvcm1hdCBhbmQgUmVzcG9uc2VDaGVja1R4Lgp0eXBlIFJlc3VsdCBzdHJ1Y3QgewoJLy8gQ29kZSBpcyB0aGUgcmVzcG9uc2UgY29kZSwgaXMgc3RvcmVkIGJhY2sgb24gdGhlIGNoYWluLgoJQ29kZSBDb2RlVHlwZQoKCS8vIENvZGVzcGFjZSBpcyB0aGUgc3RyaW5nIHJlZmVycmluZyB0byB0aGUgZG9tYWluIG9mIGFuIGVycm9yCglDb2Rlc3BhY2UgQ29kZXNwYWNlVHlwZQoKCS8vIERhdGEgaXMgYW55IGRhdGEgcmV0dXJuZWQgZnJvbSB0aGUgYXBwLgoJLy8gRGF0YSBoYXMgdG8gYmUgbGVuZ3RoIHByZWZpeGVkIGluIG9yZGVyIHRvIHNlcGFyYXRlCgkvLyByZXN1bHRzIGZyb20gbXVsdGlwbGUgbXNncyBleGVjdXRpb25zCglEYXRhIFtdYnl0ZQoKCS8vIExvZyBjb250YWlucyB0aGUgdHhzIGxvZyBpbmZvcm1hdGlvbi4gTk9URTogbm9uZGV0ZXJtaW5pc3RpYy4KCUxvZyBzdHJpbmcKCgkvLyBHYXNXYW50ZWQgaXMgdGhlIG1heGltdW0gdW5pdHMgb2Ygd29yayB3ZSBhbGxvdyB0aGlzIHR4IHRvIHBlcmZvcm0uCglHYXNXYW50ZWQgdWludDY0CgoJLy8gR2FzVXNlZCBpcyB0aGUgYW1vdW50IG9mIGdhcyBhY3R1YWxseSBjb25zdW1lZC4gTk9URTogdW5pbXBsZW1lbnRlZAoJR2FzVXNlZCB1aW50NjQKCgkvLyBFdmVudHMgY29udGFpbnMgYSBzbGljZSBvZiBFdmVudCBvYmplY3RzIHRoYXQgd2VyZSBlbWl0dGVkIGR1cmluZyBzb21lCgkvLyBleGVjdXRpb24uCglFdmVudHMgRXZlbnRzCn0="}})],1),e._v(" "),l("p",[e._v("Next is an example of how to return a "),l("code",[e._v("Result")]),e._v(" from the "),l("code",[e._v("gov")]),e._v(" module:")]),e._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"CXJldHVybiBzZGsuUmVzdWx0ewoJCURhdGE6ICAgR2V0UHJvcG9zYWxJREJ5dGVzKHByb3Bvc2FsLlByb3Bvc2FsSUQpLAoJCUV2ZW50czogY3R4LkV2ZW50TWFuYWdlcigpLkV2ZW50cygpLAoJfQ=="}})],1),e._v(" "),l("p",[e._v("For a deeper look at "),l("code",[e._v("handler")]),e._v("s, see this "),l("a",{attrs:{href:"https://github.com/cosmos/sdk-application-tutorial/blob/c6754a1e313eb1ed973c5c91dcc606f2fd288811/x/nameservice/handler.go",target:"_blank",rel:"noopener noreferrer"}},[e._v("example implementation of a "),l("code",[e._v("handler")]),e._v(" function"),l("OutboundLink")],1),e._v(" from the nameservice tutorial.")]),e._v(" "),l("h2",{attrs:{hide:"",id:"next"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#next"}},[e._v("#")]),e._v(" Next")]),e._v(" "),l("p",{attrs:{hide:""}},[e._v("Learn about "),l("RouterLink",{attrs:{to:"/building-modules/querier.html"}},[e._v("queriers")])],1)],1)}),[],!1,null,null,null);g.default=t.exports}}]);