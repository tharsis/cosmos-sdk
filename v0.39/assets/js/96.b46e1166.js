(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{867:function(e,t,r){"use strict";r.r(t);var o=r(1),a=Object(o.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"queriers"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#queriers"}},[e._v("#")]),e._v(" Queriers")]),e._v(" "),r("h2",{attrs:{hide:"",id:"pre-requisite-readings"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pre-requisite-readings"}},[e._v("#")]),e._v(" Pre-requisite Readings")]),e._v(" "),r("ul",[r("li",{attrs:{prereq:""}},[r("RouterLink",{attrs:{to:"/building-modules/module-manager.html"}},[e._v("Module Manager")])],1),e._v(" "),r("li",{attrs:{prereq:""}},[r("RouterLink",{attrs:{to:"/building-modules/messages-and-queries.html"}},[e._v("Messages and Queries")])],1)]),e._v(" "),r("h2",{attrs:{id:"querier-type"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#querier-type"}},[e._v("#")]),e._v(" "),r("code",[e._v("Querier")]),e._v(" type")]),e._v(" "),r("p",[e._v("The "),r("code",[e._v("querier")]),e._v(" type defined in the Cosmos SDK specifies the typical structure of a "),r("code",[e._v("querier")]),e._v(" function:")]),e._v(" "),r("p",[r("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSB0eXBlcwoKaW1wb3J0IGFiY2kgJnF1b3Q7Z2l0aHViLmNvbS90ZW5kZXJtaW50L3RlbmRlcm1pbnQvYWJjaS90eXBlcyZxdW90OwoKLy8gVHlwZSBmb3IgcXVlcmllciBmdW5jdGlvbnMgb24ga2VlcGVycyB0byBpbXBsZW1lbnQgdG8gaGFuZGxlIGN1c3RvbSBxdWVyaWVzCnR5cGUgUXVlcmllciA9IGZ1bmMoY3R4IENvbnRleHQsIHBhdGggW11zdHJpbmcsIHJlcSBhYmNpLlJlcXVlc3RRdWVyeSkgKHJlcyBbXWJ5dGUsIGVyciBFcnJvcikK"}})],1),e._v(" "),r("p",[e._v("Let us break it down:")]),e._v(" "),r("ul",[r("li",[e._v("The "),r("code",[e._v("path")]),e._v(" is an array of "),r("code",[e._v("string")]),e._v("s that contains the type of the query, and that can also contain "),r("code",[e._v("query")]),e._v(" arguments. See "),r("RouterLink",{attrs:{to:"/building-modules/messages-and-queries.html#queries"}},[r("code",[e._v("queries")])]),e._v(" for more information.")],1),e._v(" "),r("li",[e._v("The "),r("code",[e._v("req")]),e._v(" itself is primarily used to retrieve arguments if they are too large to fit in the "),r("code",[e._v("path")]),e._v(". This is done using the "),r("code",[e._v("Data")]),e._v(" field of "),r("code",[e._v("req")]),e._v(".")]),e._v(" "),r("li",[e._v("The "),r("RouterLink",{attrs:{to:"/core/context.html"}},[r("code",[e._v("Context")])]),e._v(" contains all the necessary information needed to process the "),r("code",[e._v("query")]),e._v(", as well as a cache-wrapped copy of the latest state. It is primarily used by the "),r("RouterLink",{attrs:{to:"/building-modules/keeper.html"}},[r("code",[e._v("keeper")])]),e._v(" to access the state.")],1),e._v(" "),r("li",[e._v("The result "),r("code",[e._v("res")]),e._v(" returned to "),r("code",[e._v("baseapp")]),e._v(", marhsalled using the application's "),r("RouterLink",{attrs:{to:"/core/encoding.html"}},[r("code",[e._v("codec")])]),e._v(".")],1)]),e._v(" "),r("h2",{attrs:{id:"implementation-of-a-module-queriers"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#implementation-of-a-module-queriers"}},[e._v("#")]),e._v(" Implementation of a module "),r("code",[e._v("querier")]),e._v("s")]),e._v(" "),r("p",[e._v("Module "),r("code",[e._v("querier")]),e._v("s are typically implemented in a "),r("code",[e._v("./internal/keeper/querier.go")]),e._v(" file inside the module's folder. The "),r("RouterLink",{attrs:{to:"/building-modules/module-manager.html"}},[e._v("module manager")]),e._v(" is used to add the module's "),r("code",[e._v("querier")]),e._v("s to the "),r("RouterLink",{attrs:{to:"/core/baseapp.html#query-routing"}},[e._v("application's "),r("code",[e._v("queryRouter")])]),e._v(" via the "),r("code",[e._v("NewQuerier()")]),e._v(" method. Typically, the manager's "),r("code",[e._v("NewQuerier()")]),e._v(" method simply calls a "),r("code",[e._v("NewQuerier()")]),e._v(" method defined in "),r("code",[e._v("keeper/querier.go")]),e._v(", which looks like the following:")],1),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBOZXdRdWVyaWVyKGtlZXBlciBLZWVwZXIpIHNkay5RdWVyaWVyIHsKCXJldHVybiBmdW5jKGN0eCBzZGsuQ29udGV4dCwgcGF0aCBbXXN0cmluZywgcmVxIGFiY2kuUmVxdWVzdFF1ZXJ5KSAoW11ieXRlLCBlcnJvcikgewoJCXN3aXRjaCBwYXRoWzBdIHsKCQljYXNlIFF1ZXJ5VHlwZTE6CgkJCXJldHVybiBxdWVyeVR5cGUxKGN0eCwgcGF0aFsxOl0sIHJlcSwga2VlcGVyKQoKCQljYXNlIFF1ZXJ5VHlwZTI6CgkJCXJldHVybiBxdWVyeVR5cGUyKGN0eCwgcGF0aFsxOl0sIHJlcSwga2VlcGVyKQoKCQlkZWZhdWx0OgoJCQlyZXR1cm4gbmlsLCBzZGtlcnJvcnMuV3JhcGYoc2RrZXJyb3JzLkVyclVua25vd25SZXF1ZXN0LCAmcXVvdDt1bmtub3duICVzIHF1ZXJ5IGVuZHBvaW50OiAlcyZxdW90OywgdHlwZXMuTW9kdWxlTmFtZSwgcGF0aFswXSkKCQl9Cgl9Cn0K"}}),e._v(" "),r("p",[e._v("This simple switch returns a "),r("code",[e._v("querier")]),e._v(" function specific to the type of the received "),r("code",[e._v("query")]),e._v(". At this point of the "),r("RouterLink",{attrs:{to:"/interfaces/query-lifecycle.html"}},[e._v("query lifecycle")]),e._v(", the first element of the "),r("code",[e._v("path")]),e._v(" ("),r("code",[e._v("path[0]")]),e._v(") contains the type of the query. The following elements are either empty or contain arguments needed to process the query.")],1),e._v(" "),r("p",[e._v("The "),r("code",[e._v("querier")]),e._v(" functions themselves are pretty straighforward. They generally fetch a value or values from the state using the "),r("RouterLink",{attrs:{to:"/building-modules/keeper.html"}},[r("code",[e._v("keeper")])]),e._v(". Then, they marshall the value(s) using the "),r("RouterLink",{attrs:{to:"/core/encoding.html"}},[r("code",[e._v("codec")])]),e._v(" and return the "),r("code",[e._v("[]byte")]),e._v(" obtained as result.")],1),e._v(" "),r("p",[e._v("For a deeper look at "),r("code",[e._v("querier")]),e._v("s, see this "),r("a",{attrs:{href:"https://github.com/cosmos/sdk-application-tutorial/blob/c6754a1e313eb1ed973c5c91dcc606f2fd288811/x/nameservice/internal/keeper/querier.go",target:"_blank",rel:"noopener noreferrer"}},[e._v("example implementation of a "),r("code",[e._v("querier")]),e._v(" function"),r("OutboundLink")],1),e._v(" from the nameservice tutorial.")]),e._v(" "),r("h2",{attrs:{hide:"",id:"next"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#next"}},[e._v("#")]),e._v(" Next")]),e._v(" "),r("p",{attrs:{hide:""}},[e._v("Learn about "),r("RouterLink",{attrs:{to:"/building-modules/beginblock-endblock.html"}},[r("code",[e._v("BeginBlocker")]),e._v(" and "),r("code",[e._v("EndBlocker")])])],1)],1)}),[],!1,null,null,null);t.default=a.exports}}]);